* DSP MERES - VASS GABOR ES TOTH BALINT - III.EVF. INFO, 1995
* INTERP2.ASM
* LINEARIS INTERPOLACIO HAROMSZOG ALAKU H[K]-VAL

PRD	EQU 3		* BELSO ORA CIKLUSA
IMR	EQU 4		* IT MASZK
GREQ	EQU 5		* LOKALIS ES GLOBALIS MEMORIA HATARA

XN	EQU 0		* 6-OS LAP SEGEDVALTOZOI
XNM8	EQU 8
H0      EQU 10
H8      EQU +18
YN      EQU +20
MODE    EQU +21
ONE     EQU +22

	AORG 0
	B SETUP		* RESET HATASARA
CH0     DATA 0
CH1     DATA >2000
CH2     DATA >4000
CH3     DATA >6000
CH4     DATA >7FFF
CH5     DATA >6000
CH6     DATA >4000
CH7     DATA >2000
CH8     DATA 0

	AORG >18
	B TINT		* BELSO TIMER IT RUTIN CIME

	AORG >20
SETUP	EQU $
	DINT		* IT TILTAS
	LDPK 0		* 0-AS ADATLAP
	LALK >80
	SACL GREQ	* >80 LOKALIS, FELETTE GLOBALIS MEM.
	LACK >08
	SACL IMR	* BELSO ORA IT ENGEDELYEZES
	LALK +249
	SACL PRD	* BELSO ORA INIT (40KHZ ES KIMENET)
	LDPK >6		* 6-OS ADATLAP
        LACK 1
        SACL ONE
        LRLK AR0,>300+H8
        LARK AR1,8
        LACK CH8
        LARP AR0
LOAD    TBLR *-,AR1
        SUB ONE
        BANZ LOAD,*-,AR0
        LACK 1
        SACL MODE
	EINT		* IT ENGEDELYEZES

WAIT	IDLE		* VEGTELEN CIKLUS
	B WAIT

TINT	EQU $		* IT RUTIN: A FELDOLGOZAS
        LAC MODE
	SUBK 1
	SACL MODE
        BNZ NULLAK
	LACK 4
	SACL MODE
	IN XN,PA2	* A/D OLVASASA
        OUT XN,PA0
        B TOVABB
NULLAK  LACK 0
        SACL XN
TOVABB  EQU $
*	OUT XN,PA0
        LRLK AR0,>300+XNM8
        LRLK AR1,>300+H8
	LRLK AR2,8
	ZAC
	LARP AR0
	LT *-,AR1
	MPY *-,AR0

LOOP	LTD *-,AR1
	MPY *-,AR2
        BANZ LOOP,*-,AR0

	APAC
	SACH YN,1
	OUT YN,PA2	* KIMENET IRASA
	OUT YN,PA7	* TRIGGER
	RET

	END
